<canvas id="gc" width="400" height="400"></canvas>

<script>
window.onload = function(){
    canv = document.getElementById("gc");
    ctx = canv.getContext("2d");
    document.addEventListener("keydown",  keyPush  );
    setInterval(game, 1000/15);
}
xv = 1;
yv = 0;

    px = py = 10; // player
    gs = tc = 20;
    ax = ay = 15; // apple
    trail=[];
    tail = 5;
    pause = 1;
        
function game(){

    if( ! pause ){
        px += xv;
        py += yv;
    }
    if(px< 0 ){
        px = tc -1;
    }
    if(px>tc-1){
        px =0;
    }
    if (py < 0){
        py = tc-1;
    }
    if(py > tc-1)
    {
        py =0;
    }

        ctx.fillStyle="black";
        ctx.fillRect(0, 0,canv.width, canv.height);

        ctx.fillStyle = "blue";
        for(var i = 0; i< trail.length; i++){
            ctx.fillRect( trail[i].x*gs, trail[i].y*gs, gs-2, gs-2);
            
            if(trail[i].x == px && trail[i].y == py )
            {
                tail = 5;
            }
        }
        if(!pause){
            trail.push( {x:px, y:py} );
            while(trail.length > tail){
                trail.shift();
            }
            
            if(ax == px && ay == py){
                tail++;
                ax = Math.floor(Math.random() * tc);
                ay = Math.floor(Math.random() * tc);
            }
        }
        
        ctx.fillStyle = "red";
        ctx.fillRect(ax*gs, ay*gs, gs-2, gs-2);
}

function keyPush(evt){
    console.log(evt.keyCode);
    switch(evt.keyCode){
        case 37:
                if(pause){
        pause  = !pause;
        }

        xv = -1; yv = 0;
        break;
        case 38:
                if(pause){
        pause  = !pause;
        }

        xv = 0; yv = -1;
        break;
        case 39:
                if(pause){
        pause  = !pause;
        }

        xv = 1; yv = 0;
        break;
        case 40:
                if(pause){
        pause  = !pause;
        }

        xv = 0; yv = 1;
        break;
        case 32:
        pause = !pause;
        break;
    }
}
</script>
